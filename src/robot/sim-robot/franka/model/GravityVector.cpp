/*
 * GravityVector.cpp
 *
 *  Created on: 24 feb 2019
 *     Authors: Oliva Alexander, Gaz Claudio, Cognetti Marco
 *
 *  C. Gaz, M. Cognetti, A. Oliva, P. Robuffo Giordano, A. De Luca, 'Dynamic
 *  Identification of the Franka Emika Panda Robot With Retrieval of Feasible
 *  Parameters Using Penalty-Based Optimization'. IEEE RA-L, 2019.
 *
 */

#include "franka_model.h"

namespace franka_model {

  vpColVector gravityVector(const vpColVector &q)
  {
    vpColVector g(njoints, 0);
    double cq1, cq2, cq3, cq4, cq5, cq6, sq1, sq2, sq3, sq4, sq5, sq6;

    cq1 = cos(q[1]);
    cq2 = cos(q[2]);
    cq3 = cos(q[3]);
    cq4 = cos(q[4]);
    cq5 = cos(q[5]);
    cq6 = cos(q[6]);

    sq1 = sin(q[1]);
    sq2 = sin(q[2]);
    sq3 = sin(q[3]);
    sq4 = sin(q[4]);
    sq5 = sin(q[5]);
    sq6 = sin(q[6]);

    g[0] = 0.0;
    g[1] = cq1*5.264978817778941E-2-sq1*3.042587371153542E1-cq1*cq2*6.740633340233102+cq1*sq2*2.292451005113512E-1-cq3*sq1*1.685261200851765E1+sq1*sq3*4.793843800969591+sq1*sq3*sq4*7.556341752565437E-1+cq1*cq2*cq3*4.793843800969591+cq1*cq2*sq3*1.685261200851765E1+cq1*cq4*sq2*7.556341752565437E-1+cq3*cq5*sq1*6.640253492168912E-1-cq1*sq2*sq4*9.810525836736536E-2+cq4*sq1*sq3*9.810525836736536E-2-cq3*sq1*sq5*1.624775272283397+cq1*cq2*cq3*cq4*9.810525836736536E-2+cq1*cq2*cq3*sq4*7.556341752565437E-1-cq1*cq2*cq5*sq3*6.640253492168912E-1+cq1*cq4*cq6*sq2*4.789098204946713E-3+cq1*cq2*sq3*sq5*1.624775272283397+cq1*cq5*sq2*sq4*1.624775272283397-cq1*cq4*sq2*sq6*6.110287240797736E-2-cq4*cq5*sq1*sq3*1.624775272283397-cq3*cq6*sq1*sq5*6.110287240797736E-2+cq1*sq2*sq4*sq5*6.640253492168912E-1-cq4*sq1*sq3*sq5*6.640253492168912E-1+cq6*sq1*sq3*sq4*4.789098204946713E-3-cq3*sq1*sq5*sq6*4.789098204946713E-3-sq1*sq3*sq4*sq6*6.110287240797736E-2-cq1*cq2*cq3*cq4*cq5*1.624775272283397-cq1*cq2*cq3*cq4*sq5*6.640253492168912E-1+cq1*cq2*cq3*cq6*sq4*4.789098204946713E-3-cq1*cq2*cq3*sq4*sq6*6.110287240797736E-2+cq1*cq2*cq6*sq3*sq5*6.110287240797736E-2+cq1*cq5*cq6*sq2*sq4*6.110287240797736E-2-cq4*cq5*cq6*sq1*sq3*6.110287240797736E-2+cq1*cq2*sq3*sq5*sq6*4.789098204946713E-3+cq1*cq5*sq2*sq4*sq6*4.789098204946713E-3-cq4*cq5*sq1*sq3*sq6*4.789098204946713E-3-cq1*cq2*cq3*cq4*cq5*cq6*6.110287240797736E-2-cq1*cq2*cq3*cq4*cq5*sq6*4.789098204946713E-3;
    g[2] = cq2*sq1*2.292451005113512E-1+sq1*sq2*6.740633340233102-sq1*sq2*sq3*1.685261200851765E1+cq2*cq4*sq1*7.556341752565437E-1-cq3*sq1*sq2*4.793843800969591-cq2*sq1*sq4*9.810525836736536E-2+cq2*cq4*cq6*sq1*4.789098204946713E-3-cq3*cq4*sq1*sq2*9.810525836736536E-2+cq2*cq5*sq1*sq4*1.624775272283397-cq2*cq4*sq1*sq6*6.110287240797736E-2-cq3*sq1*sq2*sq4*7.556341752565437E-1+cq5*sq1*sq2*sq3*6.640253492168912E-1+cq2*sq1*sq4*sq5*6.640253492168912E-1-sq1*sq2*sq3*sq5*1.624775272283397+cq3*cq4*cq5*sq1*sq2*1.624775272283397+cq2*cq5*cq6*sq1*sq4*6.110287240797736E-2+cq3*cq4*sq1*sq2*sq5*6.640253492168912E-1-cq3*cq6*sq1*sq2*sq4*4.789098204946713E-3+cq2*cq5*sq1*sq4*sq6*4.789098204946713E-3+cq3*sq1*sq2*sq4*sq6*6.110287240797736E-2-cq6*sq1*sq2*sq3*sq5*6.110287240797736E-2-sq1*sq2*sq3*sq5*sq6*4.789098204946713E-3+cq3*cq4*cq5*cq6*sq1*sq2*6.110287240797736E-2+cq3*cq4*cq5*sq1*sq2*sq6*4.789098204946713E-3;
    g[3] = cq1*cq3*-4.793843800969591-cq1*sq3*1.685261200851765E1-cq1*cq3*cq4*9.810525836736536E-2+cq2*cq3*sq1*1.685261200851765E1-cq1*cq3*sq4*7.556341752565437E-1+cq1*cq5*sq3*6.640253492168912E-1-cq2*sq1*sq3*4.793843800969591-cq1*sq3*sq5*1.624775272283397+cq1*cq3*cq4*cq5*1.624775272283397-cq2*cq3*cq5*sq1*6.640253492168912E-1+cq1*cq3*cq4*sq5*6.640253492168912E-1-cq1*cq3*cq6*sq4*4.789098204946713E-3-cq2*cq4*sq1*sq3*9.810525836736536E-2+cq2*cq3*sq1*sq5*1.624775272283397+cq1*cq3*sq4*sq6*6.110287240797736E-2-cq1*cq6*sq3*sq5*6.110287240797736E-2-cq2*sq1*sq3*sq4*7.556341752565437E-1-cq1*sq3*sq5*sq6*4.789098204946713E-3+cq1*cq3*cq4*cq5*cq6*6.110287240797736E-2+cq1*cq3*cq4*cq5*sq6*4.789098204946713E-3+cq2*cq4*cq5*sq1*sq3*1.624775272283397+cq2*cq3*cq6*sq1*sq5*6.110287240797736E-2+cq2*cq4*sq1*sq3*sq5*6.640253492168912E-1-cq2*cq6*sq1*sq3*sq4*4.789098204946713E-3+cq2*cq3*sq1*sq5*sq6*4.789098204946713E-3+cq2*sq1*sq3*sq4*sq6*6.110287240797736E-2+cq2*cq4*cq5*cq6*sq1*sq3*6.110287240797736E-2+cq2*cq4*cq5*sq1*sq3*sq6*4.789098204946713E-3;
    g[4] = sq1*sq2*sq4*-7.556341752565437E-1-cq1*cq4*sq3*7.556341752565437E-1-cq4*sq1*sq2*9.810525836736536E-2+cq1*sq3*sq4*9.810525836736536E-2+cq2*cq3*cq4*sq1*7.556341752565437E-1-cq1*cq4*cq6*sq3*4.789098204946713E-3-cq2*cq3*sq1*sq4*9.810525836736536E-2+cq4*cq5*sq1*sq2*1.624775272283397-cq1*cq5*sq3*sq4*1.624775272283397+cq1*cq4*sq3*sq6*6.110287240797736E-2+cq4*sq1*sq2*sq5*6.640253492168912E-1-cq1*sq3*sq4*sq5*6.640253492168912E-1-cq6*sq1*sq2*sq4*4.789098204946713E-3+sq1*sq2*sq4*sq6*6.110287240797736E-2+cq2*cq3*cq4*cq6*sq1*4.789098204946713E-3+cq2*cq3*cq5*sq1*sq4*1.624775272283397-cq2*cq3*cq4*sq1*sq6*6.110287240797736E-2+cq4*cq5*cq6*sq1*sq2*6.110287240797736E-2-cq1*cq5*cq6*sq3*sq4*6.110287240797736E-2+cq2*cq3*sq1*sq4*sq5*6.640253492168912E-1+cq4*cq5*sq1*sq2*sq6*4.789098204946713E-3-cq1*cq5*sq3*sq4*sq6*4.789098204946713E-3+cq2*cq3*cq5*cq6*sq1*sq4*6.110287240797736E-2+cq2*cq3*cq5*sq1*sq4*sq6*4.789098204946713E-3;
    g[5] = cq1*cq3*cq5*1.624775272283397+cq1*cq3*sq5*6.640253492168912E-1+cq1*cq3*cq5*cq6*6.110287240797736E-2+cq1*cq4*cq5*sq3*6.640253492168912E-1+cq1*cq3*cq5*sq6*4.789098204946713E-3+cq2*cq5*sq1*sq3*1.624775272283397-cq1*cq4*sq3*sq5*1.624775272283397+cq2*sq1*sq3*sq5*6.640253492168912E-1+cq5*sq1*sq2*sq4*6.640253492168912E-1-sq1*sq2*sq4*sq5*1.624775272283397-cq2*cq3*cq4*cq5*sq1*6.640253492168912E-1+cq2*cq3*cq4*sq1*sq5*1.624775272283397+cq2*cq5*cq6*sq1*sq3*6.110287240797736E-2-cq1*cq4*cq6*sq3*sq5*6.110287240797736E-2+cq2*cq5*sq1*sq3*sq6*4.789098204946713E-3-cq1*cq4*sq3*sq5*sq6*4.789098204946713E-3-cq6*sq1*sq2*sq4*sq5*6.110287240797736E-2-sq1*sq2*sq4*sq5*sq6*4.789098204946713E-3+cq2*cq3*cq4*cq6*sq1*sq5*6.110287240797736E-2+cq2*cq3*cq4*sq1*sq5*sq6*4.789098204946713E-3;
    g[6] = cq1*cq3*cq6*sq5*4.789098204946713E-3-cq4*cq6*sq1*sq2*6.110287240797736E-2+cq1*cq6*sq3*sq4*6.110287240797736E-2-cq1*cq3*sq5*sq6*6.110287240797736E-2-cq4*sq1*sq2*sq6*4.789098204946713E-3+cq1*sq3*sq4*sq6*4.789098204946713E-3+cq1*cq4*cq5*cq6*sq3*4.789098204946713E-3-cq2*cq3*cq6*sq1*sq4*6.110287240797736E-2-cq1*cq4*cq5*sq3*sq6*6.110287240797736E-2-cq2*cq3*sq1*sq4*sq6*4.789098204946713E-3+cq2*cq6*sq1*sq3*sq5*4.789098204946713E-3+cq5*cq6*sq1*sq2*sq4*4.789098204946713E-3-cq2*sq1*sq3*sq5*sq6*6.110287240797736E-2-cq5*sq1*sq2*sq4*sq6*6.110287240797736E-2-cq2*cq3*cq4*cq5*cq6*sq1*4.789098204946713E-3+cq2*cq3*cq4*cq5*sq1*sq6*6.110287240797736E-2;

    return g;
  }

}
